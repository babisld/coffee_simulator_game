FYI 
All the problems mentioned in comments in the original code are fixed
Only thing that is bugging is the fugly appearance
